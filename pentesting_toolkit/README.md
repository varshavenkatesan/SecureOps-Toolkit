# Penetration Testing Toolkit

## Overview

The Penetration Testing Toolkit is an educational suite of tools demonstrating common penetration testing techniques. It includes a network port scanner and a brute force attack simulator, designed to teach security concepts and defensive strategies.

## Modules

### 1. Port Scanner
TCP port scanner for network reconnaissance and service discovery.

### 2. Brute Force Simulator
Educational demonstration of authentication attacks using local dummy credentials.

### 3. Utility Functions
Common helper functions for network operations and validation.

## ⚠️ CRITICAL ETHICAL WARNING

**THIS TOOLKIT IS FOR EDUCATIONAL PURPOSES ONLY**

### Legal Use:
✓ Your own networks and systems  
✓ Authorized penetration testing engagements  
✓ Educational lab environments  
✓ Controlled training scenarios  
✓ Bug bounty programs (within their scope)  

### ILLEGAL Use:
✗ Scanning networks without permission  
✗ Attacking systems you don't own  
✗ Any unauthorized access attempts  
✗ Testing production systems without authorization  

**WARNING**: Unauthorized use of these tools is ILLEGAL under:
- Computer Fraud and Abuse Act (CFAA) - USA
- Computer Misuse Act - UK
- Similar cybercrime laws worldwide

**Penalties**: Heavy fines and imprisonment (up to 20 years in some jurisdictions)

## Installation

No external dependencies required. Uses Python standard library only.

```bash
cd pentesting_toolkit
python port_scanner.py    # For port scanning
python brute_forcer.py    # For brute force simulation
```

## Module 1: Port Scanner

### Features
- **TCP Connect Scanning**: Full TCP connection to detect open ports
- **Multithreading**: Fast scanning with concurrent threads
- **Service Detection**: Identifies common services by port
- **Flexible Scanning**: Common ports, custom ranges, or all ports
- **DNS Resolution**: Supports hostnames and IP addresses

### Usage

```bash
python port_scanner.py
```

**Interactive Prompts:**
1. Enter target IP or hostname
2. Confirm authorization
3. Select scan type:
   - Common ports (fast)
   - Custom port range
   - All ports (slow)

### Example

```
$ python port_scanner.py

========================================
NETWORK PORT SCANNER
========================================

Enter target IP or hostname: scanme.nmap.org
[*] Resolving hostname: scanme.nmap.org
[+] Resolved to: 45.33.32.156

[?] Do you have authorization (yes/no): yes

--- SCAN TYPE ---
1. Scan Common Ports (Fast)
2. Scan Port Range
3. Scan All Ports

Enter your choice: 1

[*] Scanning common ports...
[+] Port    22/tcp  open  SSH
[+] Port    80/tcp  open  HTTP
[+] Port   443/tcp  open  HTTPS

========================================
SCAN RESULTS
========================================
Ports Scanned:  14
Open Ports:     3
Elapsed Time:   2.34 seconds
```

### How It Works

1. **DNS Resolution**: Resolves hostname to IP if needed
2. **Socket Creation**: Creates TCP socket for each port
3. **Connection Attempt**: Tries to establish connection
4. **Result Analysis**: Success = open port, timeout/refuse = closed
5. **Service Mapping**: Maps port numbers to known services

### Technical Details

**Method**: TCP Connect Scan  
**Protocol**: TCP (Transmission Control Protocol)  
**Timeout**: 1 second per port  
**Default Threads**: 50 concurrent connections  
**Common Ports Scanned**: 14 (FTP, SSH, HTTP, HTTPS, MySQL, RDP, etc.)

### Advantages
- Simple and reliable
- Works without root/admin privileges
- Accurate results
- Good for educational purposes

### Limitations
- Not stealthy (leaves logs)
- Slower than SYN scanning
- Can be detected by IDS/IPS
- Requires full TCP handshake

### Defense Against Port Scanning

**For System Administrators:**
1. **Firewall Rules**: Block unnecessary ports
2. **Intrusion Detection**: Monitor for scan patterns
3. **Port Knocking**: Hide services until authenticated
4. **Rate Limiting**: Throttle connection attempts
5. **Log Analysis**: Review connection logs regularly

**Detection Indicators:**
- Multiple connections from single IP
- Sequential port access
- Short connection durations
- Connections to uncommon ports

## Module 2: Brute Force Simulator

### Features
- **Dictionary Attack**: Tests common passwords
- **Safe Simulation**: Uses local dummy credentials only
- **Educational Focus**: Detailed explanations and countermeasures
- **Attack Metrics**: Tracks attempts, time, and success rate
- **No Network Activity**: Runs completely offline

### Usage

```bash
python brute_forcer.py
```

**Interactive Flow:**
1. Acknowledge educational purpose
2. Select target username from dummy accounts
3. Confirm simulation start
4. Watch attack progress
5. Learn defensive strategies

### Example

```
$ python brute_forcer.py

========================================
BRUTE FORCE ATTACK SIMULATOR
========================================

⚠️  EDUCATIONAL PURPOSE ONLY ⚠️
This is a SAFE SIMULATION using local dummy credentials.

Available dummy accounts:
  - admin
  - user
  - test
  - root
  - guest

Select target username: admin

[*] Target: admin
[*] Wordlist: 25 passwords

[001] Trying: admin:password ✗ Failed
[002] Trying: admin:123456 ✗ Failed
[003] Trying: admin:admin123 ✓ SUCCESS!

[+] Valid credentials found!
[+] Username: admin
[+] Password: admin123
[+] Attempts: 3
[+] Time: 0.32 seconds
```

### Educational Components

The simulator provides detailed information about:

1. **Attack Types**
   - Dictionary attacks
   - Credential stuffing
   - Password spraying
   - Pure brute force

2. **Real-World Impact**
   - Unauthorized access
   - Data breaches
   - Identity theft
   - Financial fraud

3. **Defense Mechanisms**
   - Strong passwords
   - Account lockout policies
   - Rate limiting
   - Multi-factor authentication
   - Monitoring and alerting

4. **Best Practices**
   - For users (password managers, MFA)
   - For developers (hashing, rate limiting)

### How It Works

1. **Wordlist Generation**: Creates list of common/weak passwords
2. **Credential Testing**: Tests each password against target
3. **Hash Comparison**: Uses SHA-256 for password validation
4. **Result Tracking**: Logs all attempts and outcomes
5. **Educational Output**: Displays security lessons

### Dummy Credentials

**Pre-configured test accounts:**
- admin:admin123
- user:password
- test:test123
- root:root
- guest:guest

**Note**: These are intentionally WEAK for demonstration purposes!

### Technical Details

**Language**: Python 3.x  
**Hashing**: SHA-256 (demonstration only, not for production)  
**Network**: None (completely offline)  
**Max Attempts**: 100 (configurable)  
**Delay**: 0.1s per attempt (simulates network latency)

### Real-World Brute Force Attacks

**Professional tools attackers use:**
- Hydra
- Medusa
- Ncrack
- John the Ripper
- Hashcat

**Our simulator vs. real attacks:**
| Feature | Our Simulator | Real Attack |
|---------|---------------|-------------|
| Target | Local dummy data | Network services |
| Speed | Slow (0.1s/attempt) | Fast (100s-1000s/sec) |
| Sophistication | Basic wordlist | Advanced patterns |
| Detection Risk | None (offline) | High (leaves logs) |

## Module 3: Utility Functions

### Available Functions

```python
# IP validation
validate_ip(ip_address)          # Check IPv4 format

# Hostname operations
validate_hostname(hostname)       # Check hostname format
resolve_hostname(hostname)        # DNS lookup

# Port operations
validate_port(port)              # Check port range (1-65535)
validate_port_range(range)       # Parse "80-443" format
get_service_name(port)           # Port to service mapping
get_common_ports()               # List of common ports

# User interface
print_banner(title)              # Formatted banner
print_section(title)             # Section header
confirm_action(message)          # Yes/no prompt

# Security
sanitize_input(input)            # Remove dangerous characters
```

### Example Usage

```python
from utils import validate_ip, get_service_name

# Validate IP
if validate_ip("192.168.1.1"):
    print("Valid IP")

# Get service name
service = get_service_name(80)  # Returns "HTTP"
```

## Security Best Practices

### For Penetration Testers

1. **Authorization**
   - Get written permission before testing
   - Define clear scope of engagement
   - Respect boundaries and exclusions

2. **Documentation**
   - Log all activities
   - Document findings clearly
   - Maintain evidence chain

3. **Responsible Disclosure**
   - Report vulnerabilities privately
   - Allow time for fixes
   - Follow disclosure policies

4. **Professionalism**
   - Minimize system impact
   - Test during agreed timeframes
   - Communicate clearly with client

### For System Administrators

1. **Network Security**
   - Minimize exposed services
   - Use firewalls effectively
   - Segment network properly
   - Monitor for suspicious activity

2. **Authentication**
   - Enforce strong passwords
   - Implement MFA everywhere
   - Use account lockout policies
   - Monitor failed logins

3. **Monitoring**
   - Deploy IDS/IPS systems
   - Review logs regularly
   - Set up automated alerts
   - Conduct regular audits

4. **Patch Management**
   - Keep systems updated
   - Apply security patches quickly
   - Test updates before deployment
   - Maintain update schedule

## Defensive Strategies

### Against Port Scanning

```bash
# Firewall rule examples (iptables)
# Rate limit connections
iptables -A INPUT -p tcp --dport 22 -m recent --set
iptables -A INPUT -p tcp --dport 22 -m recent --update --seconds 60 --hitcount 4 -j DROP

# Use fail2ban for automated blocking
apt-get install fail2ban
```

### Against Brute Force

```python
# Example: Rate limiting in Python/Flask
from flask_limiter import Limiter

limiter = Limiter(
    app,
    key_func=get_remote_address,
    default_limits=["5 per minute"]
)

@app.route("/login", methods=["POST"])
@limiter.limit("3 per minute")
def login():
    # Login logic here
    pass
```

## Comparison with Professional Tools

| Feature | Our Toolkit | Nmap | Metasploit |
|---------|-------------|------|------------|
| Purpose | Educational | Scanning | Exploitation |
| Complexity | Simple | Medium | Advanced |
| Features | Basic | Extensive | Comprehensive |
| Learning Curve | Easy | Moderate | Steep |
| Legal Risk | Low (local) | Medium | High |

**When to use professional tools:**
- Authorized penetration testing
- Professional security assessments
- Advanced vulnerability research
- Production security audits

## Future Enhancements

- [ ] SYN scanning (stealth mode)
- [ ] UDP port scanning
- [ ] OS fingerprinting
- [ ] Service version detection
- [ ] Vulnerability exploitation framework
- [ ] Network mapping
- [ ] Packet crafting
- [ ] SSL/TLS analysis
- [ ] Web application fingerprinting
- [ ] Report generation (PDF/HTML)

## Legal Framework

### Key Laws to Know

**United States:**
- Computer Fraud and Abuse Act (CFAA)
- Electronic Communications Privacy Act (ECPA)
- State-specific computer crime laws

**United Kingdom:**
- Computer Misuse Act 1990
- Data Protection Act 2018
- Police and Justice Act 2006

**European Union:**
- GDPR (data protection)
- Network and Information Security Directive
- Various national cybercrime laws

### Legal Penetration Testing

**Required Documentation:**
1. Written authorization letter
2. Scope of work document
3. Rules of engagement
4. Non-disclosure agreement
5. Liability insurance

**Professional Certifications:**
- CEH (Certified Ethical Hacker)
- OSCP (Offensive Security Certified Professional)
- GPEN (GIAC Penetration Tester)
- CPTE (Certified Penetration Testing Engineer)

## Educational Resources

### Online Platforms
- HackTheBox - Legal hacking practice
- TryHackMe - Guided security learning
- OverTheWire - War games
- PentesterLab - Web security

### Books
- "The Web Application Hacker's Handbook"
- "Metasploit: The Penetration Tester's Guide"
- "Black Hat Python"
- "Penetration Testing: A Hands-On Introduction"

### Communities
- OWASP - Open Web Application Security Project
- /r/netsec - Reddit security community
- Security conferences (DEF CON, Black Hat)

## Disclaimer

This toolkit is provided for **EDUCATIONAL PURPOSES ONLY**.

The authors and contributors:
- Are NOT responsible for any misuse
- Do NOT encourage illegal activities
- Assume NO liability for damages
- Provide NO warranties of any kind

**YOU are solely responsible for:**
- Obtaining proper authorization
- Complying with all applicable laws
- Using tools ethically and legally
- Any consequences of your actions

**Unauthorized use may result in:**
- Criminal prosecution
- Civil lawsuits
- Financial penalties
- Imprisonment
- Permanent criminal record

## Ethical Hacker's Code

As a security professional or student:

1. **Respect privacy and property**
2. **Only test with authorization**
3. **Do no harm**
4. **Disclose responsibly**
5. **Improve security for everyone**
6. **Educate others**
7. **Follow the law**

## Support and Contact

For educational questions or contributions:
- Open an issue on GitHub
- Submit pull requests
- Join security communities
- Attend security meetups

**Remember**: Knowledge is power. Use it responsibly.

---

**Module 3 of SecureOps Toolkit**  
For other modules, see the main project README.
